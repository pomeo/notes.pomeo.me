<!DOCTYPE html>
<html lang='ru'>
  <head>
    <meta charset='utf-8' />
    <meta content='width=775' name='viewport' />
    <title>
      Install LXC (Linux Containers)
    </title>
    <link href='/stylesheets/styles.css' rel='stylesheet' />
    <link href='/favicon.png' rel='shortcut icon' type='image/png' />
    <link href='/atom.xml' rel='alternate' title='RSS' type='application/rss+xml' />
    <script src='/javascripts/highlight.pack.js'></script>
    <link href='/stylesheets/zenburn.css' rel='stylesheet' />
    <script>
      hljs.initHighlightingOnLoad();
    </script>
  </head>
  <body>
    <div class='wrapper'>
      <div class='main'>
        <div class='post'>
          <h1>
            Install LXC (Linux Containers)
          </h1>
          <p><a href="http://lxc.sourceforge.net">http://lxc.sourceforge.net</a></p>
          <pre><code class="bash">$ sudo apt-get install lxc bridge-utils&#x000A;$ sudo lxc-create -n name -t ubuntu -- -r lucid&#x000A;</code></pre>
          <p>create /etc/network/if-up.d/lxc</p>
          <pre><code class="bash">#!/bin/bash&#x000A;# script to setup a natted network for lxc guests&#x000A;CMD_BRCTL=/sbin/brctl&#x000A;CMD_IFCONFIG=/sbin/ifconfig&#x000A;CMD_IPTABLES=/sbin/iptables&#x000A;CMD_ROUTE=/sbin/route&#x000A;NETWORK_BRIDGE_DEVICE_NAT=lxc-bridge-nat&#x000A;HOST_NETDEVICE=eth0&#x000A;PRIVATE_GW_NAT=10.0.2.1&#x000A;PRIVATE_NETMASK=255.255.255.0&#x000A;&#x000A;${CMD_BRCTL} addbr ${NETWORK_BRIDGE_DEVICE_NAT}&#x000A;${CMD_BRCTL} setfd ${NETWORK_BRIDGE_DEVICE_NAT} 0&#x000A;${CMD_IFCONFIG} ${NETWORK_BRIDGE_DEVICE_NAT} ${PRIVATE_GW_NAT} netmask ${PRIVATE_NETMASK} promisc up&#x000A;${CMD_IPTABLES} -t nat -A POSTROUTING -o ${HOST_NETDEVICE} -j MASQUERADE&#x000A;echo 1 &gt; /proc/sys/net/ipv4/ip_forward&#x000A;</code></pre>
          <p>insert in <em>/var/lib/lxc/name/config</em></p>
          <pre><code class="bash">lxc.network.type = veth&#x000A;lxc.network.flags = up&#x000A;lxc.network.link = lxc-bridge-nat                      &#x000A;lxc.network.name = eth0                                         &#x000A;lxc.network.hwaddr = ac:de:48:00:0x:xx&#x000A;lxc.network.ipv4 = 10.0.2.xxx/24&#x000A;</code></pre>
          <pre><code class="bash">echo "nameserver 8.8.8.8" &gt; /var/lib/lxc/name/rootfs/etc/resolvconf/resolv.conf.d/base&#x000A;</code></pre>
          <p>edit <em>/var/lib/lxc/name/rootfs/etc/network/interfaces</em></p>
          <pre><code class="bash">auto lo&#x000A;iface lo inet loopback&#x000A;&#x000A;auto eth0&#x000A;iface eth0 inet static&#x000A;  address   10.0.2.xxx&#x000A;  netmask   255.255.255.0&#x000A;  gateway   10.0.2.1&#x000A;</code></pre>
          <p>run</p>
          <pre><code class="bash">$ sudo lxc-start --name name_container&#x000A;</code></pre>
          <p>login <em>root</em> / password <em>root</em></p>
          
          <p>for boot on startup<br />
          LXC &lt; 0.7.5</p>
          <pre><code class="bash">$ sudo ln -s /var/lib/lxc/name/config /etc/lxc/name.conf&#x000A;</code></pre>
          <p>edit <em>/etc/default/lxc</em> add</p>
          <pre><code class="bash">CONTAINERS="name"&#x000A;</code></pre>
          <p>LXC &gt;=0.7.5</p>
          <pre><code class="bash">$ sudo ln -s /var/lib/lxc/name/config /etc/lxc/auto/name.conf&#x000A;</code></pre>
        </div>
      </div>
    </div>
  </body>
</html>
